# Таблица требований безопасности

| ID     | Название | Описание | Метрика/Порог | Проверка (чем/где) | Компонент | Приоритет |
|--------|----------|----------|---------------|--------------------|-----------|-----------|
| NFR-01 | Контроль доступа | Реализовать ролевую модель: пользователь может управлять только своими списками желаний | 0 нарушений доступа при тестах | `pytest + FastAPI TestClient` | `presentation.*` | High |
| NFR-02 | Безопасное хранение паролей | Пароли хэшируются с помощью `bcrypt` | `password ≠ password_hash` | `unit-test` при регистрации пользователя | `use_cases.auth` | High |
| NFR-03 | Ограничение попыток логина | После 5 неудачных попыток подряд аккаунт блокируется на 10 мин | ≤ 5 попыток за 10 мин | `pytest` функциональный тест | `use_cases.auth` | High |
| NFR-04 | Валидация входных данных | Все поля запросов проходят серверную валидацию | 100 % схем через Pydantic | `unit-test` | `presentation.*` | High |
| NFR-05 | Безопасность конфигурации | Секреты (JWT, DB, SMTP) берутся из переменных окружения | отсутствуют «жёстко» прописанные секреты | инспекция кода | `settings.py` | High |
| NFR-06 | Логирование событий безопасности | Неудачные логины и 5ти ошибках записываются в `security.log` | ≥ 95% событий логируются | просмотр `security.log` | `core.logging` | Medium |
| NFR-07 | Защита от `XSS` | Ответы `API` не содержат необработанных HTML-вставок | 0 случаев XSS при автотестах | `unit-test` | `presentation.*` | Medium |
| NFR-08 | Ограничение размера тела запроса | Максимум 1 МБ на `POST/PUT` | ≤ 2 МБ | middleware-проверка | `presentation.*` | Low |
